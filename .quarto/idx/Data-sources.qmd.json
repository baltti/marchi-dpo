{"title":"Открытые источники данных","markdown":{"yaml":{"title":"Открытые источники данных","format":"html"},"headingText":"Загрузка данных из OpenStreetMap","containsRefs":false,"markdown":"\n\n\n**OpenStreetMap (OSM)** --- проект, который создаёт и предоставляет свободные географические данные, дает возможность создавать карты любому пользователю. Каждый желающий может поучаствовать в проекте (загружать свои треки на сервер, дорисовывать общедоступную карту по спутниковым снимкам Bing, MapBox, DigitalGlobe (весь мир), IRS (запад России), SPOT4 (восток России) и SPOT (Белоруссия) от Космоснимки.ру, ASTER (Россия), OrbView-3 и другими) и использовать эти карты совершенно свободно, и бесплатно в отличие от многих других карт, даже бесплатных, свободное использование которых ограничено.\n\nКарты этого проекта очень широко используются как в некоммерческих целях, например, для исследовательских проектов, так и для коммерческих проектов, например, создания навигационных приложений.\n\nВот очень любопытный [прецедент](http://shtosm.ru/all/vserossiyskaya-perepis-pod-ugrozoy/) использования OSM в нашей стране.\n\n::: callout-caution\nБезусловно следует помнить, что OSM как источник данных весьма и весьма несовершенен, так как запооняется пользователями, однако он продалжает оставаться самым большим набором пространственных данных в мире.\n:::\n\n## Сервис overpass-turbo {#overpass}\n\nОдин из самых простых способов скачивания пространственных данных с OSM - это использование сервиса <http://overpass-turbo.eu/>.\n\nЕсть еще вот такой [сервис](https://yourmaps.io/) русскоязычный, но там довольно много ограничений в бесплатной версии.\n\nПодробная информация о сервисе [[https://wiki.openstreetmap.org/wiki/Overpass_turbo]{.underline}](https://wiki.openstreetmap.org/wiki/Overpass_turbo)\n\nДля создания запросов используется собственный язык запросов **Overpass QL** (Overpass Query Language)[^1].\n\n[^1]: Overpass API/Overpass QL <https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL>\n\nЕсть несколько различных типов *формулировок* Overpass QL . Они сгруппированы в:\n\n-   *Параметры,* которые являются необязательными глобальными переменными, устанавливаются в первом операторе запроса. Примерами *настроек* являются тайм-аут сервера для сервера Overpass API и формат вывода запроса Overpass QL.\n\n-   *Операторы блока* : *операторы* блока группируют операторы Overpass QL вместе.\n\n-   *Автономные запросы*: это самостоятельные полные утверждения. Они могут выполнять такие функции, как запрос к серверу Overpass API для создания набора; манипулирование содержимым существующего набора; или отправка конечных результатов запроса в место вывода. Автономные запросы сами по себе состоят из более мелких языковых компонентов Overpass QL, таких как оценщики, фильтры и операторы.\n\nНа самом деле, чтобы составить запрос вам не обязательно знать все тонкости языка запросов. Вот основные моменты, которые необходимы для запроса:\n\n-   то, как объекты обозначаются в OSM - ключ и его значение;\n-   тип объектов (не обязательно, а только, если вы хотите выгружать конкретный тип объектов - точки, линии или полигоны);\n-   охват территории поиска - bounding box (по умолчанию задается по видимой части карты в правой половине окна, но можно задать непосредственно в запросе или выбрать вручную на карте).\n\nПодробная информация о том, какие объекты как [обозначаются в OpenStreetMap](https://wiki.openstreetmap.org/wiki/RU:%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B_%D0%BA%D0%B0%D1%80%D1%82%D1%8B). На этой странице можно искать нужный вам тип объектов, чтобы составить запрос.\n\nВ левой части окна будет отображаться выполняемый запрос, а в правой результаты этого запроса. По умолчанию поиск осуществляется в той области, которая отображается в правой части окна (это можно скорректировать более сложными запросами, см. справку о сервисе).\n\n![](images/13.PNG)\n\nДля составления запросов используется помощник. Обратите внимание, что в нем сразу можно использовать логические операторы.\n\n![](images/14.PNG)\n\n> Для примера можно найти и загрузить данные по многоквартирным жилым домам (*building=apartments*) и основным магистральным улицам (*highway=primary or highway=secondary or highway=tertiary,* то есть центральные магистрали, основные магистрали районов и основные микрорайонные или межмикрорайонные транзитные улицы) в Санкт-Петербурге.\n\nПервый запрос по поиску жилых домов выглядит примерно так. Обратите внимание, что я убрала пункт ***node***, чтобы у нас не производился поиск точечных объектов.\n\n![](images/15.PNG)\n\nВ результате запроса получим объекты на карте.\n\n> По умолчанию поиск объектов производится внутри видимой области карты в правой части окна, но с помощью кнопок управления, расположенных в этой части окна вы можете выбрать, например, прямоугольную область поиска.\n\n![](images/16.PNG)\n\nВ нижнем правом углу окна видно, сколько объектов какого типа было найдено, а сколько отображено.\n\nЭспортируем результаты себе на компьютер для дальнейшей работы с ними в QGIS. Для этого нужно нажать кнопку **Экспорт**, после чего появится диалоговое окно экспорта.\n\n![](images/17.PNG)\n\nДанные можно сохранить себе в формате geojson, о котором говорилось в предыдущем разделе \\@ref(formats), кроме этого формата данные также можно скачать в GPX, KML, в виде сырых данных, а также в виде данных для редактирования OSM.\n\nПредварителльно проверим свой файл в сервисе [geojson.io](geojson.io).\n\nЗдесь достаточно будет просто перетащить ваш файл в правую часть окна. Если с файлом все в порядке и геометрия валидна, то на карте должны отобразиться объекты, а в правой части будет структура geojson файла.\n\n![](images/18.PNG)\n\nОткроем полученные данные в QGIS.\n\nДобавление слоя осуществляется через строку меню **Слой** $\\longrightarrow$ **Добавить слой** $\\longrightarrow$ **Добавить векторный слой**.\n\n![](images/19.png)\n\nДалее в диалоговом окне нужно указать путь к файлу.\n\n![](images/20.PNG)\n\n> На самом деле не обязательно пользоваться строкой меню и ее пунктом Слой, все то же самое можно делать через окно Браузер в левой части интерфейса. Это скорее вопрос привычки.\n>\n> Но нужно помнить, что процесс открытия через строку меню более контролируемый.\n\nЕсли вы открыли новый проект, то в нем нужно выполнить перепроецирование на лету и добавить подложку. Как это сделать было описано в \\@ref(basemap).\n\nВ результате должно получиться что-то подобное.\n\n![Карта с добавленной подложкой и слоями жилых многоквартирных домов и супермаркетов](images/21.PNG)\n\n![Карта с добавленными слоями жилых многоквартирных домов, улиц и супермаркетами](images/22.PNG)\n\nВ таблицах атрибутов будет содержаться информация об объектах, которая внесена в OSM.\n\nОткрыть таблицу атрибутов слоя можно из контекстного меню, которое открывается правым кликом на название слоя.\n\n![](images/23.png)\n\n> **Атрибуты** - это те характеристики объектов, которые не являются пространственными.\n\nТаблица атрибутов открывается в отдельном окне.\n\n![](images/24.PNG)\n\nПри необходимости мы можем добавлять и удалять отдельные поля, а также осуществлять операции между полями (об этом чуть подробнее будет на следующих занятиях).\\\nДля добавления и удаления полей нужно включить режим редактирования таблицы в ее панели инструментов (значок ![](images/25.PNG)). После этого в панели инструментов таблицы станут активными кнопки добавления и удаления полей ![](images/26.PNG).\n\nПри удалении полей следует просто выбрать поля, которые вы собираетесь удалить в перечне (можно выделять сразу несколько названий полей, используя кнопки Shift и CTRL).\n\nПри добавлении нового поля обязательно нужно задать его имя и тип данных, которые будут в нем храниться.\\\n\n## Модуль QuickOSM {#quickosm}\n\nКроме непосредственного использования сервиса можно скачивать данные OSM напрямую из QGIS с помощью модуля **QuickOSM**.\n\nКак устанавливать модули уже было рассказано ранее в \\@ref(QMS).\n\n![](images/27.png)\n\nПосле установки модуля на панели инструментов появятся два значка ![](images/28.png), левый из которых запускает окно поиска и загрузки данных из OSM, а правый позволяет удаленно подключаться к редактированию OSM через редактор JOSM[^2].\n\n[^2]: <https://josm.ru/>\n\nОкно модуля по умолчанию открывается на вкладке **Быстрый запрос**.\n\n![](images/29.png)\n\nКнопка **Помощью с ключами/значениями** открывает страницу с документацией модуля <https://docs.3liz.org/QuickOSM/>\n\nНа второй строке находятся строка выбора пресетов (**Preset**) - готовый запросов по поиску объектов, поэтому если вы не очень уверены в том, как какие-либо объекты обозначаются, но знаете, какие вам нужны, можно попробовать найти уже готовый запрос здесь.\n\nСразу под этой строкой находится таблица, где вы можете выбирать конкретные ключи и их значения.\n\n> Запрос может включать в себя сразу несколько пар ключ/значение, но в этом случае части запроса должны быть связаны одним из логических операторов ***AND*** или ***OR***.\n>\n> Главное отличие в применении этих операторов состоит в том, что при выборе ***AND*** поиск объектов будет осуществляться с учетом того, что все части запроса должны *выполняться одновременно*.\n>\n> При использовании оператора ***OR*** будет производится поиск объектов, *удовлетворяющих хотя бы одному условию из заданных*.\n\nСразу под таблицей необходимо задать область поиска:\n\n![](images/30.png)\n\n-   **В** - поиск в заданном населенном пункте;\n\n-   **Вокруг** - поиск в заданном радиусе вокруг населенного пункта;\n\n-   **Покрывать холст** - поиск в пределах видимой в основном окне программы части карты;\n\n-   **Покрывать слой** - поиск в пределах охвата конкретного слоя (необходимо выбрать нужный слой);\n\n-   **Не пространственные** - не заданная конкретная область, поэтому поиск будет производиться во всех данных OSM вне зависимости от местоположения.\n\nСвой запрос вы можете сохранить в виде пресета (**Save query in a new preset**), просмотреть его (**Показать запрос**) и **Выполнить запрос**.\n\nПри нажатии на кнопку **Показать запрос** у вас откроется вкладка **Запрос**, где текст вашего запроса будет показан на языке запросов Overpass аналогично тому, как было рассмотрено выше в \\@ref(overpass).\n\n![](images/31.png)\n\nПри желании, запрос можно писать прямо здесь.\n\nВ пункте **Query history** на вкладке **Быстрый запрос** у вас будут отображаться уже сделанные вами запросы.\n\nВ дополнительных настройках быстрого запроса можно указать:\n\n![](images/32.png)\n\n-   тип объекта для поиска;\n\n-   время ожидания при выполнении запроса;\n\n-   путь к папке для сохранения результатов запроса и формат сохранения данных, а также префикс файла для более простой идентификации.\n\n> **!NB** по умолчанию результаты запроса сохраняются во *временные слои*, обозначенные значком ![](images/33.png)\n>\n> Эти слои *существуют только во время текущего сеанса работы*, так что если вы планируете работать с ними далее, то их необходимо сохранить. Сделать это можно, кликнув правой кнопкой мыши на название слоя и выбрав пункт **Сохранить на диск** или **Экспорт --- Сохранить объекты как...**\n>\n> ![](images/34.png)\n\n> Также обратите внимание, что по одному и тому же запросу могут возвращаться объекты с разными типами геометрии, причем каждый из этих типов сохраняется в отдельный слой.\n\nНа вкладке **Map preset** вы увидите существующий по умолчанию в модуле пресет Urban, а также свои сохраненные в виде пресетов запросы.\n\n![](images/35.png)\n\nВкладка **OSM файл** позволяет загружать сырые данные из OSM для их редактирования.\n\nВ **Параметрах** вы можете выбрать конкретный сервер Overpass для соединения и сервер Nominatim[^3].\n\n[^3]: В данном случае этот сервис нужен для осуществления геокодирования, то есть поиска положения населенного пункта по его названию\n\n![](images/36.png)\n\nЕсли запросы осуществляются слишком медленно или не осуществляются вообще, выбор другого сервера может помочь решить эту проблему.\n\n## Дополнительно\n\nКроме непосредственного использования Overpass можно воспользоваться **OSM-GPT** - сервисом на основе ChatGPT, который позволяет делать запросы с использованием естественного языка.\n\n<https://osm-gpt.rohitgautam.com.np/>\n\n```{=html}\n<video width=\"540\" height=\"360\" controls>\n  <source src=\"images/255709707-f43a7a5e-3780-4421-a007-96afe55c683c.mp4\" type=\"video/mp4\">\n</video>\n```\n\nПри желании более подробно ознакомиться с логикой построения запросов и языком запросов, вы можете воспользоваться интерактивным учебником <https://osmlab.github.io/learnoverpass//en/>\n\nИли взять уже готовые запросы из коллекции запросов <https://osm-queries.ldodds.com/>\n\n## Исторические данные OSM\n\nЕсли вы хотите загрузить не последние актуальные данные OSM, а какие-то исторические, то самым простым способом будет загрузка данных из сервиса Geofabrik - <https://download.geofabrik.de/>.\n\nНа странице загрузки вы можете выбрать интересующий вас регион и скачать данные для него в формате *.osm.pbf*[^4] (может быть добавлен в ваш проект как любой другой векторный слой) или *.shp.zip (*заархивированный shapefile).\n\n[^4]: подробнее о формате <https://wiki.openstreetmap.org/wiki/RU:PBF_Format>\n\n![](images/Снимок%20экрана%202025-03-02%20в%2016.54.05.png){fig-align=\"center\"}\n\n::: callout-caution\nЗдесь тоже следует помнить, что, если данных не было в OSM ранее, это не значит, что этих объектов не существовало, возможно они просто были добавлены туда позднее.\n:::\n\nЕдиницы территориального деления различного уровня организованы в иерархическую структуру, то есть можно спускаться до необходимого вам уровня детализации региона.\n\n![](images/Снимок%20экрана%202025-03-02%20в%2017.03.11.png){fig-align=\"center\"}\n\nНа каждой странице региона вы увидите пункт *Other formats and Auxiliary Files*, в котором есть пункт *raw directory index*, позволяющий перейти к архивным данным за определенные даты и загрузить их.\n\n![](images/Снимок%20экрана%202025-03-02%20в%2017.04.56.png){fig-align=\"center\"}\n\n::: callout-tip\nЛюбознательные и неленивые могут попробовать воспользоваться более продвинутыми инструментами:\n\n-   [Osmium](https://osmcode.org/osmium-tool/) и немного о работе с ним <https://habr.com/ru/articles/785254/>\n\n-   [OSHDB](https://wiki.openstreetmap.org/wiki/OSHDB) - OpenStreetMap History Data Analysis ([подробное описание и документация](https://github.com/giscience/oshdb))\n:::\n\n# Загрузка данных с Wikipedia и WikiData[^5]\n\n[^5]: На основе <https://gis4arch.blogspot.com/2020/11/wikipedia-wikidata.html>\n\n::: callout-caution\nТочно так же, как и OSM эти источники данных весьма несовершенны, поэтому их следует использовать с аккуратностью.\n:::\n\n## Поиск по статьям Wikipedia\n\nВ Wikipedia есть поиск по статьям, содержащим в себе координаты объектов.\n\nНекоторые примеры запросов, могут быть найдены в документации по [ссылке](https://en.wikipedia.org/w/api.php?action=help&modules=query%2Bgeosearch).\n\nПоиск объектов в пределах радиуса 1000 метров от точки с координатами 37° 47′ 13.1″ N, 122° 23′ 58.84″ W:\n\n```         \nhttps://en.wikipedia.org/w/api.php?action=query&list=geosearch&gsradius=10000&gscoord=37.786971|-122.399677\n```\n\nПоиск объектов в пределах заданного охвата:\n\n```         \nhttps://en.wikipedia.org/w/api.php?action=query&list=geosearch&gsbbox=37.8|-122.3|37.7|-122.4\n```\n\n::: callout-tip\nДля выполнения запроса достаточно просто вставить его в адресную строку браузера.\n:::\n\nОсновная часть запроса это `list=geosearch (gs)`, остальное уже является дополнительными параметрами для задания определенной области поиска:\n\n-   **gscoord** - координаты точки, вокруг которой будет идти поиск (широта и долгота с разделением \\| );\n\n-   **gspage** - название страницы, вокруг объекта которой нужно осуществлять поиск;\n\n-   **gsbbox** - охват поиска (координаты левого верхнего и правого нижнего углов с разделением \\| );\n\n-   **gsradius -** радиус поиска в метрах (может быть только целым числом от 10 до 10000, значение по умолчанию - 500);\n\n-   и некоторые другие, позволяющие более точно настроить поиск.\n\nДля того, чтобы осуществлять поиск только по русскоязычным статьям, достаточно просто заменить в запросе `en` на `ru`.\n\n```         \nhttps://ru.wikipedia.org/w/api.php?action=query&list=geosearch&gsradius=10000&gscoord=37.786971|-122.399677\n```\n\n::: callout-warning\nКоличество объектов, которое возвращается по запросу устанавливается параметром `gslimit`, но максимальное количество объектов может быть не более 500. Значение этого параметра по умолчанию - 10.\n:::\n\nПример запроса для Москвы:\n\n```         \nhttps://ru.wikipedia.org/w/api.php?action=query&generator=geosearch&redirects=1&prop=coordinates|langlinkscount|info&ggslimit=500&ggsradius=1000&ggscoord=55.75|37.55&colimit=500&format=json\n```\n\nРезультат показан на рисунке ниже.\n\n![](images/wiki.PNG){fig-align=\"center\"}\n\n```{=html}\n<iframe width=\"800\" height=\"400\" src=\"https://www.youtube.com/embed/bWIVBJP6sqs?si=eMAS9vKKrkiIkqYO\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n```\n\n## Поиск по Wikidata\n\n«**Викида́нные**» (англ. Wikidata) — совместно редактируемая база знаний, созданная Фондом Викимедиа. Используется для обеспечения централизованного хранения данных, которые могут использоваться в других проектах, в том числе в статьях Википедии — например, интервики-ссылок, значков статусных статей и списков или статистической информации: дат рождения, численности населения и т. п.[^6]\n\n[^6]: Источник <https://ru.wikipedia.org/wiki/%D0%92%D0%B8%D0%BA%D0%B8%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5>\n\nХранение данных основано в виде так называемых *утверждений (statements)*.\n\n> Утверждения — это способ хранения любой информации об известном элементе. Формально, они состоят из пар ключ-значение, которые хранят соответствие свойства (например, «автор», или «дата публикации») с одним или несколькими значениями (например, «Артур Конан-Дойл» или «1902»).\n\n![](images/Wikidata_statement.svg.png){fig-align=\"center\"}\n\nЗапросы осуществляются на языке подобном SQL - SparQL[^7].\n\n[^7]: <https://www.wikidata.org/wiki/Wikidata:SPARQL_tutorial>\n\nС различными примерами составления запросов можно ознакомиться по [ссылке](https://www.wikidata.org/wiki/Wikidata:SPARQL_query_service/queries/examples).\n\nПример запроса в заданном радиусе от определенной точки (вы можете попробовать запустить его по [ссылке](https://w.wiki/nC2)):\n\n```\nSELECT ?place ?placeLabel ?location ?period ?fame ?distance\nWHERE\n{\n  SERVICE wikibase:around { \n      ?place wdt:P625 ?location . \n      bd:serviceParam wikibase:center \"Point(37.55 55.75)\"^^geo:wktLiteral.\n      bd:serviceParam wikibase:radius \"10\". # kilometers\n      bd:serviceParam wikibase:distance ?distance. \n  } \n    ?place wikibase:sitelinks ?fame .\n    OPTIONAL { ?place wdt:P571 ?period }.\n#    FILTER NOT EXISTS { \n#    {?place wdt:P31 wd:Q123705 .}\n#      UNION\n#    { ?place wdt:P31 wd:Q7553685 .}\n#    }\n  SERVICE wikibase:label {\n    bd:serviceParam wikibase:language \"ru\" . \n  }\n}\n```\n\nПример запроса в определенном охвате (вы можете попробовать запустить его по [ссылке](https://w.wiki/nBr)):\n\n```\nSELECT ?place ?placeLabel ?location ?period ?fame\nWHERE\n{\n  SERVICE wikibase:box { \n      ?place wdt:P625 ?location . \n      bd:serviceParam wikibase:cornerSouthWest \"Point(37.55 55.70)\"^^geo:wktLiteral.\n      bd:serviceParam wikibase:cornerNorthEast \"Point(37.70 55.80)\"^^geo:wktLiteral.\n  } \n    ?place wikibase:sitelinks ?fame .\n    OPTIONAL { ?place wdt:P571 ?period }.\n  \n  SERVICE wikibase:label {\n    bd:serviceParam wikibase:language \"ru\" . \n  }\n}\n\n```\n\n\n::: callout-tip\nКроме того, можете посмотреть подробное видео по работе с Wikidata (англ.) - <https://youtu.be/kJph4q0Im98?si=lJLUlJR6s_wEbvbk>\n\nили более краткий туториал на русском языке\n\n```{=html}\n<iframe width=\"800\" height=\"400\" src=\"https://www.youtube.com/embed/t-5MyYJFmmE?si=6Fq6hWEqtpFSk4Kr\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n```\n:::\n\n## Данные об объектах культурного наследния Wikivoyage\n\n**Wikivoyage (Викигид** <http://wikivoyage.org/>) **-** проект по созданию открытого всемирного путеводителя.\n\nДля загрузки данных можно воспользоваться парсером данных, код которого доступен по [ссылке](https://github.com/trolleway/wikivoyage2geodata?tab=readme-ov-file).\n\nЛибо можно скачать готовую выгрузку по результатам работы парсера по [ссылке](https://trolleway.nextgis.com/resource/2478/display?angle=0&zoom=10&styles=5214&base=osm-mapnik&lon=37.8454&lat=55.7225).\n\n```{=html}\n<iframe src=\"https://trolleway.nextgis.com/resource/2478/display/tiny?angle=0&zoom=10&styles=5214&linkMainMap=true&events=false&panel=none&controls=&panels=&base=osm-mapnik&lon=37.8454&lat=55.7225\" style=\"overflow:hidden;height:600px;width:800px\" height=\"600\" width=\"800\"></iframe>\n```\n\n# Градостроительные данные\n\n::: callout-important\nК сожалению, в нашей стране отсутствует какой-либо каталог различных порталов градостроительных данных, которые регионы создают самостоятельно, поэтому конкретные данные для нужного региона следует искать на региональных порталах.\n\nПримеры региональных порталов:\n\n-   Москва <https://gisogd.mos.ru/home>\n\n-   Санкт-Петербург <https://portal.kgainfo.spb.ru/kgamap>\n\n-   Ленинградская область <https://gisogd.lenobl.ru/app/7/layers>\n:::\n\n::: callout-note\nНо большинство градостроительных порталов позволяет выгружать данные только в текстовом или растровом виде (в виде картинки), что требует последующей привязки этих растров и векторизации.\n:::\n\nВ настоящее время есть сервис \"Градостроительная проработка онлайн\" - <https://nspd.gov.ru/urban-analyze>\n\n![](images/1.png){fig-align=\"center\"}\n\n![](images/2.png){fig-align=\"center\"}\n\n![Источник: https://kola.gov-murman.ru/news/press-relizy/519676/](images/3.png){fig-align=\"center\"}\n\n::: callout-note\nЭтот сервис тоже может выдавать данные только в текстовом виде.\n:::\n\n# Данные ЕГРН\n\n## Получение данных Национальной структуры пространственных данных\n\n::: callout-caution\nПоказанный ниже метод опирается на не задокументированный доступ через инструменты разработки в браузере.\n:::\n\n```{=html}\n<iframe src=\"https://rutube.ru/play/embed/4a14444a2b99278f2b348ec1668d75a2/\" width=\"720\" height=\"405\" frameBorder=\"0\" allow=\"clipboard-write\" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>\n```\n\n```{=html}\n<iframe width=\"720\" height=\"405\" src=\"https://rutube.ru/play/embed/c5e7367799c24329c03edf90dfceab87/\" frameBorder=\"0\" allow=\"clipboard-write\" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>\n```\n\n## Получение данных из выписок ЕГРН и КПТ\n\nЕсли у вас есть выписка из ЕГРН на объект недвижимости или кадастровый план территории на кадастровый квартал в формате *.xml*, то вы можете попробовать загрузить данные из них в QGIS.\n\nНо их загрузка требует извлечения пространственной составляющей (координат характерных точек объектов недвижимости). Самый простой способ конвертации - онлайн-сервис от компании ПолигонПРО:\n\n-   **Конвертер XML-файлов в формат Shapefile** <https://polygon.top/ws/shp/>\n\n-   **Конвертер XML-файлов в формат MIF/MID** <https://polygon.top/ws/mif/>\n\n![](images/Снимок%20экрана%202025-03-02%20в%2019.30.14.png){fig-align=\"center\"}\n\nПолученные в результате конвертации файлы после разархивирования могут быть открыты как обычные векторные файлы.\n\n::: callout-important\nПолученные координаты будут представлены в местной системе координат для конкретного кадастрового округа, так как используются именно внесенные в ЕГРН данные.\n\nПоэтому дополнительно нужно задать параметры местной системы координат в QGIS.\n\nВ каталоге систем координат QGIS содержится порядка 5000 тысяч описаний систем координат, однако иногда их использования недостаточно, тогда вы можете добавить в каталог свою пользовательскую систему координат. Это можно сделать через строку меню **Настройки --- Пользовательские проекции**.\n\n![](images/76.png)\n\nПосле этого вам откроется окно, в котором можно задать параметры нужной вам системы координат в формате WKT или proj.\n\n![](images/77.png)\n\n> Описание параметров различных систем координат можно найти, например, [здесь](https://terraingis.ru/category/dannye-dlya-gis/msk).\n\n![](images/78.png)\n\nПосле добавления ваша система координат станет доступна в каталоге как для перепроецирования на лету, так и для перепроецирования слоев в разделе Пользовательские системы координат.\n\n![](images/79.png)\n:::\n\nСкорее всего открытый векторный файл будет отображаться в вашем проекте как файл без проекции или с ошибочной системой координат (справа от имени файла будет иконка с вопросительным знаком ![](images/Снимок%20экрана%202025-03-02%20в%2020.37.38.png){width=\"31\"}).\n\nДля присвоения ему нужной системы координат следует просто кликнуть по названию файла правой кнопкой и выбрать пункт *Система координат слоя* $\\longrightarrow$ *Изменить систему координат слоя* (или же выбрать из предлагаемого списка недавно использованных систем координат нужную).\n\n![](images/Снимок%20экрана%202025-03-02%20в%2020.38.14.png){fig-align=\"center\"}\n\nПосле этого слой будет отображаться на вашей карте должным образом.\n\nЕсли у вас нет выписки из ЕГРН или кадастрового плана территории, то вы можете скачать их для нужной территории/объектов из [Архива КПТ](https://polygon.top/ws/fir/).\n\n::: callout-caution\nСервис загрузки данных из архива КПТ является платным.\n\nТакже следует помнить, что данные загружаются пользователями сервиса и могут быть уже неактуальными.\n:::\n\n## Подключение национальной системы пространственных данных в качестве подложки\n\n::: callout-warning\nНе проверено лично мной, так что может уже не работать.\n:::\n\nВ первую очередь необходимо установить на ваш компьютер сертификаты безопасности Минцифры (доступны по ссылке <https://www.gosuslugi.ru/crt>).\n\nДалее непосредственно в настройках QGIS указать расположение этих сертификатов на компьютере.\n\n![](images/image_2024-12-24_15-16-03.png){fig-align=\"center\"}\n\nПосле этого вы можете в панели браузера создать нужное новое подключение к WMS\\\\WMTS сервис, в котором прописать ссылку на соответствующий слой подложки необходимый вам.\n\n![](images/photo_2025-03-04_11-29-44.jpg){fig-align=\"center\"}\n\nСсылки на все доступные сервисы можно посмотреть в файле <https://disk.yandex.ru/i/m7i1fmjirwWd_Q>.\n\n# Данные федерального фонда пространственных данных\n\n::: callout-warning\nДанные предоставляются только за плату.\n:::\n\nПублично-правовая компания \"Роскадастр\" предоставляет услугу по получению данных из федерального фонда пространственных данных (ФФПД) и сведения единой электронной картографической основы (ЕЭКО).\n\nОсновные виды материалов и данных ФФПД:\n\n-   Первичные и производные материалы и данные дистанционного зондирования Земли (ДЗЗ);\n\n-   Государственные топографические карты и планы;\n\n-   Геодезические материалы и данные;\n\n-   Государственные навигационные карты (планы) для автомобильного транспорта;\n\n-   Издательские, составительские оригиналы в цифровой форме и тиражные оттиски общегеографических, политико-административных, научно-справочных и других тематических карт, и атласов межотраслевого назначения;\n\n-   Материалы и данные делимитации, демаркации и проверки прохождения государственной границы РФ и материалы и данные об установлении и изменении границ субъектов РФ и границ муниципальных образований\n\n-   Справочные и другие материалы.\n\nВ состав ЕЭКО входят следующие слои:\n\n-   рельеф местности с точностью, соответствующей масштабу мельче 1:50 000,\n\n-   гидрография и гидротехнические сооружения,\n\n-   растительный покров и грунты (древесная, кустарниковая, травянистая растительность, пашни, болота, прочие земли, пески, каменистые россыпи, нарушенные земли и тому подобное),\n\n-   дорожная сеть и дорожные сооружения,\n\n-   населенные пункты,\n\n-   промышленные, сельскохозяйственные и социально-культурные объекты, в том числе жилые объекты,\n\n-   государственная граница Российской Федерации,\n\n-   границы между субъектами Российской Федерации,\n\n-   наименования географических объектов,\n\n-   иная информация, не содержащая сведений, составляющих государственную тайну, и являющихся систематизированной совокупностью пространственных данных о территории Российской Федерации.\n\nСсылка на сервис: <https://portal.fppd.cgkipd.ru/main>\n\nИнструкция и справка: <https://portal.fppd.cgkipd.ru/glavnaia>\n\n```{=html}\n<iframe width=\"800\" height=\"400\" src=\"https://www.youtube.com/embed/lbYmAOhnJWw?si=IUFcV58ILlJqCr-q\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n```\n\n# Архивные карты городов\n\nНекоторые архивные карты городов в растровом формате можно найти на сайте [https://retromap.ru/select](https://retromap.ru/select)\n\nАрхивные карты (примерно до середины двадцатого века) можно попробовать найти на сайте [https://geoportal.rgo.ru/collections](https://geoportal.rgo.ru/collections)\n\nНаиболее любознательные могут попробовать поискать архивные карты в [фонде картографических изданий РНБ](https://nlr.ru/nlr_visit/RA1918/fond-kartograficheskih-izdaniy) или в каталоге [Национальной электронной библиотеки](https://rusneb.ru/).\n","srcMarkdownNoYaml":"\n\n# Загрузка данных из OpenStreetMap\n\n**OpenStreetMap (OSM)** --- проект, который создаёт и предоставляет свободные географические данные, дает возможность создавать карты любому пользователю. Каждый желающий может поучаствовать в проекте (загружать свои треки на сервер, дорисовывать общедоступную карту по спутниковым снимкам Bing, MapBox, DigitalGlobe (весь мир), IRS (запад России), SPOT4 (восток России) и SPOT (Белоруссия) от Космоснимки.ру, ASTER (Россия), OrbView-3 и другими) и использовать эти карты совершенно свободно, и бесплатно в отличие от многих других карт, даже бесплатных, свободное использование которых ограничено.\n\nКарты этого проекта очень широко используются как в некоммерческих целях, например, для исследовательских проектов, так и для коммерческих проектов, например, создания навигационных приложений.\n\nВот очень любопытный [прецедент](http://shtosm.ru/all/vserossiyskaya-perepis-pod-ugrozoy/) использования OSM в нашей стране.\n\n::: callout-caution\nБезусловно следует помнить, что OSM как источник данных весьма и весьма несовершенен, так как запооняется пользователями, однако он продалжает оставаться самым большим набором пространственных данных в мире.\n:::\n\n## Сервис overpass-turbo {#overpass}\n\nОдин из самых простых способов скачивания пространственных данных с OSM - это использование сервиса <http://overpass-turbo.eu/>.\n\nЕсть еще вот такой [сервис](https://yourmaps.io/) русскоязычный, но там довольно много ограничений в бесплатной версии.\n\nПодробная информация о сервисе [[https://wiki.openstreetmap.org/wiki/Overpass_turbo]{.underline}](https://wiki.openstreetmap.org/wiki/Overpass_turbo)\n\nДля создания запросов используется собственный язык запросов **Overpass QL** (Overpass Query Language)[^1].\n\n[^1]: Overpass API/Overpass QL <https://wiki.openstreetmap.org/wiki/Overpass_API/Overpass_QL>\n\nЕсть несколько различных типов *формулировок* Overpass QL . Они сгруппированы в:\n\n-   *Параметры,* которые являются необязательными глобальными переменными, устанавливаются в первом операторе запроса. Примерами *настроек* являются тайм-аут сервера для сервера Overpass API и формат вывода запроса Overpass QL.\n\n-   *Операторы блока* : *операторы* блока группируют операторы Overpass QL вместе.\n\n-   *Автономные запросы*: это самостоятельные полные утверждения. Они могут выполнять такие функции, как запрос к серверу Overpass API для создания набора; манипулирование содержимым существующего набора; или отправка конечных результатов запроса в место вывода. Автономные запросы сами по себе состоят из более мелких языковых компонентов Overpass QL, таких как оценщики, фильтры и операторы.\n\nНа самом деле, чтобы составить запрос вам не обязательно знать все тонкости языка запросов. Вот основные моменты, которые необходимы для запроса:\n\n-   то, как объекты обозначаются в OSM - ключ и его значение;\n-   тип объектов (не обязательно, а только, если вы хотите выгружать конкретный тип объектов - точки, линии или полигоны);\n-   охват территории поиска - bounding box (по умолчанию задается по видимой части карты в правой половине окна, но можно задать непосредственно в запросе или выбрать вручную на карте).\n\nПодробная информация о том, какие объекты как [обозначаются в OpenStreetMap](https://wiki.openstreetmap.org/wiki/RU:%D0%9E%D0%B1%D1%8A%D0%B5%D0%BA%D1%82%D1%8B_%D0%BA%D0%B0%D1%80%D1%82%D1%8B). На этой странице можно искать нужный вам тип объектов, чтобы составить запрос.\n\nВ левой части окна будет отображаться выполняемый запрос, а в правой результаты этого запроса. По умолчанию поиск осуществляется в той области, которая отображается в правой части окна (это можно скорректировать более сложными запросами, см. справку о сервисе).\n\n![](images/13.PNG)\n\nДля составления запросов используется помощник. Обратите внимание, что в нем сразу можно использовать логические операторы.\n\n![](images/14.PNG)\n\n> Для примера можно найти и загрузить данные по многоквартирным жилым домам (*building=apartments*) и основным магистральным улицам (*highway=primary or highway=secondary or highway=tertiary,* то есть центральные магистрали, основные магистрали районов и основные микрорайонные или межмикрорайонные транзитные улицы) в Санкт-Петербурге.\n\nПервый запрос по поиску жилых домов выглядит примерно так. Обратите внимание, что я убрала пункт ***node***, чтобы у нас не производился поиск точечных объектов.\n\n![](images/15.PNG)\n\nВ результате запроса получим объекты на карте.\n\n> По умолчанию поиск объектов производится внутри видимой области карты в правой части окна, но с помощью кнопок управления, расположенных в этой части окна вы можете выбрать, например, прямоугольную область поиска.\n\n![](images/16.PNG)\n\nВ нижнем правом углу окна видно, сколько объектов какого типа было найдено, а сколько отображено.\n\nЭспортируем результаты себе на компьютер для дальнейшей работы с ними в QGIS. Для этого нужно нажать кнопку **Экспорт**, после чего появится диалоговое окно экспорта.\n\n![](images/17.PNG)\n\nДанные можно сохранить себе в формате geojson, о котором говорилось в предыдущем разделе \\@ref(formats), кроме этого формата данные также можно скачать в GPX, KML, в виде сырых данных, а также в виде данных для редактирования OSM.\n\nПредварителльно проверим свой файл в сервисе [geojson.io](geojson.io).\n\nЗдесь достаточно будет просто перетащить ваш файл в правую часть окна. Если с файлом все в порядке и геометрия валидна, то на карте должны отобразиться объекты, а в правой части будет структура geojson файла.\n\n![](images/18.PNG)\n\nОткроем полученные данные в QGIS.\n\nДобавление слоя осуществляется через строку меню **Слой** $\\longrightarrow$ **Добавить слой** $\\longrightarrow$ **Добавить векторный слой**.\n\n![](images/19.png)\n\nДалее в диалоговом окне нужно указать путь к файлу.\n\n![](images/20.PNG)\n\n> На самом деле не обязательно пользоваться строкой меню и ее пунктом Слой, все то же самое можно делать через окно Браузер в левой части интерфейса. Это скорее вопрос привычки.\n>\n> Но нужно помнить, что процесс открытия через строку меню более контролируемый.\n\nЕсли вы открыли новый проект, то в нем нужно выполнить перепроецирование на лету и добавить подложку. Как это сделать было описано в \\@ref(basemap).\n\nВ результате должно получиться что-то подобное.\n\n![Карта с добавленной подложкой и слоями жилых многоквартирных домов и супермаркетов](images/21.PNG)\n\n![Карта с добавленными слоями жилых многоквартирных домов, улиц и супермаркетами](images/22.PNG)\n\nВ таблицах атрибутов будет содержаться информация об объектах, которая внесена в OSM.\n\nОткрыть таблицу атрибутов слоя можно из контекстного меню, которое открывается правым кликом на название слоя.\n\n![](images/23.png)\n\n> **Атрибуты** - это те характеристики объектов, которые не являются пространственными.\n\nТаблица атрибутов открывается в отдельном окне.\n\n![](images/24.PNG)\n\nПри необходимости мы можем добавлять и удалять отдельные поля, а также осуществлять операции между полями (об этом чуть подробнее будет на следующих занятиях).\\\nДля добавления и удаления полей нужно включить режим редактирования таблицы в ее панели инструментов (значок ![](images/25.PNG)). После этого в панели инструментов таблицы станут активными кнопки добавления и удаления полей ![](images/26.PNG).\n\nПри удалении полей следует просто выбрать поля, которые вы собираетесь удалить в перечне (можно выделять сразу несколько названий полей, используя кнопки Shift и CTRL).\n\nПри добавлении нового поля обязательно нужно задать его имя и тип данных, которые будут в нем храниться.\\\n\n## Модуль QuickOSM {#quickosm}\n\nКроме непосредственного использования сервиса можно скачивать данные OSM напрямую из QGIS с помощью модуля **QuickOSM**.\n\nКак устанавливать модули уже было рассказано ранее в \\@ref(QMS).\n\n![](images/27.png)\n\nПосле установки модуля на панели инструментов появятся два значка ![](images/28.png), левый из которых запускает окно поиска и загрузки данных из OSM, а правый позволяет удаленно подключаться к редактированию OSM через редактор JOSM[^2].\n\n[^2]: <https://josm.ru/>\n\nОкно модуля по умолчанию открывается на вкладке **Быстрый запрос**.\n\n![](images/29.png)\n\nКнопка **Помощью с ключами/значениями** открывает страницу с документацией модуля <https://docs.3liz.org/QuickOSM/>\n\nНа второй строке находятся строка выбора пресетов (**Preset**) - готовый запросов по поиску объектов, поэтому если вы не очень уверены в том, как какие-либо объекты обозначаются, но знаете, какие вам нужны, можно попробовать найти уже готовый запрос здесь.\n\nСразу под этой строкой находится таблица, где вы можете выбирать конкретные ключи и их значения.\n\n> Запрос может включать в себя сразу несколько пар ключ/значение, но в этом случае части запроса должны быть связаны одним из логических операторов ***AND*** или ***OR***.\n>\n> Главное отличие в применении этих операторов состоит в том, что при выборе ***AND*** поиск объектов будет осуществляться с учетом того, что все части запроса должны *выполняться одновременно*.\n>\n> При использовании оператора ***OR*** будет производится поиск объектов, *удовлетворяющих хотя бы одному условию из заданных*.\n\nСразу под таблицей необходимо задать область поиска:\n\n![](images/30.png)\n\n-   **В** - поиск в заданном населенном пункте;\n\n-   **Вокруг** - поиск в заданном радиусе вокруг населенного пункта;\n\n-   **Покрывать холст** - поиск в пределах видимой в основном окне программы части карты;\n\n-   **Покрывать слой** - поиск в пределах охвата конкретного слоя (необходимо выбрать нужный слой);\n\n-   **Не пространственные** - не заданная конкретная область, поэтому поиск будет производиться во всех данных OSM вне зависимости от местоположения.\n\nСвой запрос вы можете сохранить в виде пресета (**Save query in a new preset**), просмотреть его (**Показать запрос**) и **Выполнить запрос**.\n\nПри нажатии на кнопку **Показать запрос** у вас откроется вкладка **Запрос**, где текст вашего запроса будет показан на языке запросов Overpass аналогично тому, как было рассмотрено выше в \\@ref(overpass).\n\n![](images/31.png)\n\nПри желании, запрос можно писать прямо здесь.\n\nВ пункте **Query history** на вкладке **Быстрый запрос** у вас будут отображаться уже сделанные вами запросы.\n\nВ дополнительных настройках быстрого запроса можно указать:\n\n![](images/32.png)\n\n-   тип объекта для поиска;\n\n-   время ожидания при выполнении запроса;\n\n-   путь к папке для сохранения результатов запроса и формат сохранения данных, а также префикс файла для более простой идентификации.\n\n> **!NB** по умолчанию результаты запроса сохраняются во *временные слои*, обозначенные значком ![](images/33.png)\n>\n> Эти слои *существуют только во время текущего сеанса работы*, так что если вы планируете работать с ними далее, то их необходимо сохранить. Сделать это можно, кликнув правой кнопкой мыши на название слоя и выбрав пункт **Сохранить на диск** или **Экспорт --- Сохранить объекты как...**\n>\n> ![](images/34.png)\n\n> Также обратите внимание, что по одному и тому же запросу могут возвращаться объекты с разными типами геометрии, причем каждый из этих типов сохраняется в отдельный слой.\n\nНа вкладке **Map preset** вы увидите существующий по умолчанию в модуле пресет Urban, а также свои сохраненные в виде пресетов запросы.\n\n![](images/35.png)\n\nВкладка **OSM файл** позволяет загружать сырые данные из OSM для их редактирования.\n\nВ **Параметрах** вы можете выбрать конкретный сервер Overpass для соединения и сервер Nominatim[^3].\n\n[^3]: В данном случае этот сервис нужен для осуществления геокодирования, то есть поиска положения населенного пункта по его названию\n\n![](images/36.png)\n\nЕсли запросы осуществляются слишком медленно или не осуществляются вообще, выбор другого сервера может помочь решить эту проблему.\n\n## Дополнительно\n\nКроме непосредственного использования Overpass можно воспользоваться **OSM-GPT** - сервисом на основе ChatGPT, который позволяет делать запросы с использованием естественного языка.\n\n<https://osm-gpt.rohitgautam.com.np/>\n\n```{=html}\n<video width=\"540\" height=\"360\" controls>\n  <source src=\"images/255709707-f43a7a5e-3780-4421-a007-96afe55c683c.mp4\" type=\"video/mp4\">\n</video>\n```\n\nПри желании более подробно ознакомиться с логикой построения запросов и языком запросов, вы можете воспользоваться интерактивным учебником <https://osmlab.github.io/learnoverpass//en/>\n\nИли взять уже готовые запросы из коллекции запросов <https://osm-queries.ldodds.com/>\n\n## Исторические данные OSM\n\nЕсли вы хотите загрузить не последние актуальные данные OSM, а какие-то исторические, то самым простым способом будет загрузка данных из сервиса Geofabrik - <https://download.geofabrik.de/>.\n\nНа странице загрузки вы можете выбрать интересующий вас регион и скачать данные для него в формате *.osm.pbf*[^4] (может быть добавлен в ваш проект как любой другой векторный слой) или *.shp.zip (*заархивированный shapefile).\n\n[^4]: подробнее о формате <https://wiki.openstreetmap.org/wiki/RU:PBF_Format>\n\n![](images/Снимок%20экрана%202025-03-02%20в%2016.54.05.png){fig-align=\"center\"}\n\n::: callout-caution\nЗдесь тоже следует помнить, что, если данных не было в OSM ранее, это не значит, что этих объектов не существовало, возможно они просто были добавлены туда позднее.\n:::\n\nЕдиницы территориального деления различного уровня организованы в иерархическую структуру, то есть можно спускаться до необходимого вам уровня детализации региона.\n\n![](images/Снимок%20экрана%202025-03-02%20в%2017.03.11.png){fig-align=\"center\"}\n\nНа каждой странице региона вы увидите пункт *Other formats and Auxiliary Files*, в котором есть пункт *raw directory index*, позволяющий перейти к архивным данным за определенные даты и загрузить их.\n\n![](images/Снимок%20экрана%202025-03-02%20в%2017.04.56.png){fig-align=\"center\"}\n\n::: callout-tip\nЛюбознательные и неленивые могут попробовать воспользоваться более продвинутыми инструментами:\n\n-   [Osmium](https://osmcode.org/osmium-tool/) и немного о работе с ним <https://habr.com/ru/articles/785254/>\n\n-   [OSHDB](https://wiki.openstreetmap.org/wiki/OSHDB) - OpenStreetMap History Data Analysis ([подробное описание и документация](https://github.com/giscience/oshdb))\n:::\n\n# Загрузка данных с Wikipedia и WikiData[^5]\n\n[^5]: На основе <https://gis4arch.blogspot.com/2020/11/wikipedia-wikidata.html>\n\n::: callout-caution\nТочно так же, как и OSM эти источники данных весьма несовершенны, поэтому их следует использовать с аккуратностью.\n:::\n\n## Поиск по статьям Wikipedia\n\nВ Wikipedia есть поиск по статьям, содержащим в себе координаты объектов.\n\nНекоторые примеры запросов, могут быть найдены в документации по [ссылке](https://en.wikipedia.org/w/api.php?action=help&modules=query%2Bgeosearch).\n\nПоиск объектов в пределах радиуса 1000 метров от точки с координатами 37° 47′ 13.1″ N, 122° 23′ 58.84″ W:\n\n```         \nhttps://en.wikipedia.org/w/api.php?action=query&list=geosearch&gsradius=10000&gscoord=37.786971|-122.399677\n```\n\nПоиск объектов в пределах заданного охвата:\n\n```         \nhttps://en.wikipedia.org/w/api.php?action=query&list=geosearch&gsbbox=37.8|-122.3|37.7|-122.4\n```\n\n::: callout-tip\nДля выполнения запроса достаточно просто вставить его в адресную строку браузера.\n:::\n\nОсновная часть запроса это `list=geosearch (gs)`, остальное уже является дополнительными параметрами для задания определенной области поиска:\n\n-   **gscoord** - координаты точки, вокруг которой будет идти поиск (широта и долгота с разделением \\| );\n\n-   **gspage** - название страницы, вокруг объекта которой нужно осуществлять поиск;\n\n-   **gsbbox** - охват поиска (координаты левого верхнего и правого нижнего углов с разделением \\| );\n\n-   **gsradius -** радиус поиска в метрах (может быть только целым числом от 10 до 10000, значение по умолчанию - 500);\n\n-   и некоторые другие, позволяющие более точно настроить поиск.\n\nДля того, чтобы осуществлять поиск только по русскоязычным статьям, достаточно просто заменить в запросе `en` на `ru`.\n\n```         \nhttps://ru.wikipedia.org/w/api.php?action=query&list=geosearch&gsradius=10000&gscoord=37.786971|-122.399677\n```\n\n::: callout-warning\nКоличество объектов, которое возвращается по запросу устанавливается параметром `gslimit`, но максимальное количество объектов может быть не более 500. Значение этого параметра по умолчанию - 10.\n:::\n\nПример запроса для Москвы:\n\n```         \nhttps://ru.wikipedia.org/w/api.php?action=query&generator=geosearch&redirects=1&prop=coordinates|langlinkscount|info&ggslimit=500&ggsradius=1000&ggscoord=55.75|37.55&colimit=500&format=json\n```\n\nРезультат показан на рисунке ниже.\n\n![](images/wiki.PNG){fig-align=\"center\"}\n\n```{=html}\n<iframe width=\"800\" height=\"400\" src=\"https://www.youtube.com/embed/bWIVBJP6sqs?si=eMAS9vKKrkiIkqYO\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n```\n\n## Поиск по Wikidata\n\n«**Викида́нные**» (англ. Wikidata) — совместно редактируемая база знаний, созданная Фондом Викимедиа. Используется для обеспечения централизованного хранения данных, которые могут использоваться в других проектах, в том числе в статьях Википедии — например, интервики-ссылок, значков статусных статей и списков или статистической информации: дат рождения, численности населения и т. п.[^6]\n\n[^6]: Источник <https://ru.wikipedia.org/wiki/%D0%92%D0%B8%D0%BA%D0%B8%D0%B4%D0%B0%D0%BD%D0%BD%D1%8B%D0%B5>\n\nХранение данных основано в виде так называемых *утверждений (statements)*.\n\n> Утверждения — это способ хранения любой информации об известном элементе. Формально, они состоят из пар ключ-значение, которые хранят соответствие свойства (например, «автор», или «дата публикации») с одним или несколькими значениями (например, «Артур Конан-Дойл» или «1902»).\n\n![](images/Wikidata_statement.svg.png){fig-align=\"center\"}\n\nЗапросы осуществляются на языке подобном SQL - SparQL[^7].\n\n[^7]: <https://www.wikidata.org/wiki/Wikidata:SPARQL_tutorial>\n\nС различными примерами составления запросов можно ознакомиться по [ссылке](https://www.wikidata.org/wiki/Wikidata:SPARQL_query_service/queries/examples).\n\nПример запроса в заданном радиусе от определенной точки (вы можете попробовать запустить его по [ссылке](https://w.wiki/nC2)):\n\n```\nSELECT ?place ?placeLabel ?location ?period ?fame ?distance\nWHERE\n{\n  SERVICE wikibase:around { \n      ?place wdt:P625 ?location . \n      bd:serviceParam wikibase:center \"Point(37.55 55.75)\"^^geo:wktLiteral.\n      bd:serviceParam wikibase:radius \"10\". # kilometers\n      bd:serviceParam wikibase:distance ?distance. \n  } \n    ?place wikibase:sitelinks ?fame .\n    OPTIONAL { ?place wdt:P571 ?period }.\n#    FILTER NOT EXISTS { \n#    {?place wdt:P31 wd:Q123705 .}\n#      UNION\n#    { ?place wdt:P31 wd:Q7553685 .}\n#    }\n  SERVICE wikibase:label {\n    bd:serviceParam wikibase:language \"ru\" . \n  }\n}\n```\n\nПример запроса в определенном охвате (вы можете попробовать запустить его по [ссылке](https://w.wiki/nBr)):\n\n```\nSELECT ?place ?placeLabel ?location ?period ?fame\nWHERE\n{\n  SERVICE wikibase:box { \n      ?place wdt:P625 ?location . \n      bd:serviceParam wikibase:cornerSouthWest \"Point(37.55 55.70)\"^^geo:wktLiteral.\n      bd:serviceParam wikibase:cornerNorthEast \"Point(37.70 55.80)\"^^geo:wktLiteral.\n  } \n    ?place wikibase:sitelinks ?fame .\n    OPTIONAL { ?place wdt:P571 ?period }.\n  \n  SERVICE wikibase:label {\n    bd:serviceParam wikibase:language \"ru\" . \n  }\n}\n\n```\n\n\n::: callout-tip\nКроме того, можете посмотреть подробное видео по работе с Wikidata (англ.) - <https://youtu.be/kJph4q0Im98?si=lJLUlJR6s_wEbvbk>\n\nили более краткий туториал на русском языке\n\n```{=html}\n<iframe width=\"800\" height=\"400\" src=\"https://www.youtube.com/embed/t-5MyYJFmmE?si=6Fq6hWEqtpFSk4Kr\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n```\n:::\n\n## Данные об объектах культурного наследния Wikivoyage\n\n**Wikivoyage (Викигид** <http://wikivoyage.org/>) **-** проект по созданию открытого всемирного путеводителя.\n\nДля загрузки данных можно воспользоваться парсером данных, код которого доступен по [ссылке](https://github.com/trolleway/wikivoyage2geodata?tab=readme-ov-file).\n\nЛибо можно скачать готовую выгрузку по результатам работы парсера по [ссылке](https://trolleway.nextgis.com/resource/2478/display?angle=0&zoom=10&styles=5214&base=osm-mapnik&lon=37.8454&lat=55.7225).\n\n```{=html}\n<iframe src=\"https://trolleway.nextgis.com/resource/2478/display/tiny?angle=0&zoom=10&styles=5214&linkMainMap=true&events=false&panel=none&controls=&panels=&base=osm-mapnik&lon=37.8454&lat=55.7225\" style=\"overflow:hidden;height:600px;width:800px\" height=\"600\" width=\"800\"></iframe>\n```\n\n# Градостроительные данные\n\n::: callout-important\nК сожалению, в нашей стране отсутствует какой-либо каталог различных порталов градостроительных данных, которые регионы создают самостоятельно, поэтому конкретные данные для нужного региона следует искать на региональных порталах.\n\nПримеры региональных порталов:\n\n-   Москва <https://gisogd.mos.ru/home>\n\n-   Санкт-Петербург <https://portal.kgainfo.spb.ru/kgamap>\n\n-   Ленинградская область <https://gisogd.lenobl.ru/app/7/layers>\n:::\n\n::: callout-note\nНо большинство градостроительных порталов позволяет выгружать данные только в текстовом или растровом виде (в виде картинки), что требует последующей привязки этих растров и векторизации.\n:::\n\nВ настоящее время есть сервис \"Градостроительная проработка онлайн\" - <https://nspd.gov.ru/urban-analyze>\n\n![](images/1.png){fig-align=\"center\"}\n\n![](images/2.png){fig-align=\"center\"}\n\n![Источник: https://kola.gov-murman.ru/news/press-relizy/519676/](images/3.png){fig-align=\"center\"}\n\n::: callout-note\nЭтот сервис тоже может выдавать данные только в текстовом виде.\n:::\n\n# Данные ЕГРН\n\n## Получение данных Национальной структуры пространственных данных\n\n::: callout-caution\nПоказанный ниже метод опирается на не задокументированный доступ через инструменты разработки в браузере.\n:::\n\n```{=html}\n<iframe src=\"https://rutube.ru/play/embed/4a14444a2b99278f2b348ec1668d75a2/\" width=\"720\" height=\"405\" frameBorder=\"0\" allow=\"clipboard-write\" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>\n```\n\n```{=html}\n<iframe width=\"720\" height=\"405\" src=\"https://rutube.ru/play/embed/c5e7367799c24329c03edf90dfceab87/\" frameBorder=\"0\" allow=\"clipboard-write\" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>\n```\n\n## Получение данных из выписок ЕГРН и КПТ\n\nЕсли у вас есть выписка из ЕГРН на объект недвижимости или кадастровый план территории на кадастровый квартал в формате *.xml*, то вы можете попробовать загрузить данные из них в QGIS.\n\nНо их загрузка требует извлечения пространственной составляющей (координат характерных точек объектов недвижимости). Самый простой способ конвертации - онлайн-сервис от компании ПолигонПРО:\n\n-   **Конвертер XML-файлов в формат Shapefile** <https://polygon.top/ws/shp/>\n\n-   **Конвертер XML-файлов в формат MIF/MID** <https://polygon.top/ws/mif/>\n\n![](images/Снимок%20экрана%202025-03-02%20в%2019.30.14.png){fig-align=\"center\"}\n\nПолученные в результате конвертации файлы после разархивирования могут быть открыты как обычные векторные файлы.\n\n::: callout-important\nПолученные координаты будут представлены в местной системе координат для конкретного кадастрового округа, так как используются именно внесенные в ЕГРН данные.\n\nПоэтому дополнительно нужно задать параметры местной системы координат в QGIS.\n\nВ каталоге систем координат QGIS содержится порядка 5000 тысяч описаний систем координат, однако иногда их использования недостаточно, тогда вы можете добавить в каталог свою пользовательскую систему координат. Это можно сделать через строку меню **Настройки --- Пользовательские проекции**.\n\n![](images/76.png)\n\nПосле этого вам откроется окно, в котором можно задать параметры нужной вам системы координат в формате WKT или proj.\n\n![](images/77.png)\n\n> Описание параметров различных систем координат можно найти, например, [здесь](https://terraingis.ru/category/dannye-dlya-gis/msk).\n\n![](images/78.png)\n\nПосле добавления ваша система координат станет доступна в каталоге как для перепроецирования на лету, так и для перепроецирования слоев в разделе Пользовательские системы координат.\n\n![](images/79.png)\n:::\n\nСкорее всего открытый векторный файл будет отображаться в вашем проекте как файл без проекции или с ошибочной системой координат (справа от имени файла будет иконка с вопросительным знаком ![](images/Снимок%20экрана%202025-03-02%20в%2020.37.38.png){width=\"31\"}).\n\nДля присвоения ему нужной системы координат следует просто кликнуть по названию файла правой кнопкой и выбрать пункт *Система координат слоя* $\\longrightarrow$ *Изменить систему координат слоя* (или же выбрать из предлагаемого списка недавно использованных систем координат нужную).\n\n![](images/Снимок%20экрана%202025-03-02%20в%2020.38.14.png){fig-align=\"center\"}\n\nПосле этого слой будет отображаться на вашей карте должным образом.\n\nЕсли у вас нет выписки из ЕГРН или кадастрового плана территории, то вы можете скачать их для нужной территории/объектов из [Архива КПТ](https://polygon.top/ws/fir/).\n\n::: callout-caution\nСервис загрузки данных из архива КПТ является платным.\n\nТакже следует помнить, что данные загружаются пользователями сервиса и могут быть уже неактуальными.\n:::\n\n## Подключение национальной системы пространственных данных в качестве подложки\n\n::: callout-warning\nНе проверено лично мной, так что может уже не работать.\n:::\n\nВ первую очередь необходимо установить на ваш компьютер сертификаты безопасности Минцифры (доступны по ссылке <https://www.gosuslugi.ru/crt>).\n\nДалее непосредственно в настройках QGIS указать расположение этих сертификатов на компьютере.\n\n![](images/image_2024-12-24_15-16-03.png){fig-align=\"center\"}\n\nПосле этого вы можете в панели браузера создать нужное новое подключение к WMS\\\\WMTS сервис, в котором прописать ссылку на соответствующий слой подложки необходимый вам.\n\n![](images/photo_2025-03-04_11-29-44.jpg){fig-align=\"center\"}\n\nСсылки на все доступные сервисы можно посмотреть в файле <https://disk.yandex.ru/i/m7i1fmjirwWd_Q>.\n\n# Данные федерального фонда пространственных данных\n\n::: callout-warning\nДанные предоставляются только за плату.\n:::\n\nПублично-правовая компания \"Роскадастр\" предоставляет услугу по получению данных из федерального фонда пространственных данных (ФФПД) и сведения единой электронной картографической основы (ЕЭКО).\n\nОсновные виды материалов и данных ФФПД:\n\n-   Первичные и производные материалы и данные дистанционного зондирования Земли (ДЗЗ);\n\n-   Государственные топографические карты и планы;\n\n-   Геодезические материалы и данные;\n\n-   Государственные навигационные карты (планы) для автомобильного транспорта;\n\n-   Издательские, составительские оригиналы в цифровой форме и тиражные оттиски общегеографических, политико-административных, научно-справочных и других тематических карт, и атласов межотраслевого назначения;\n\n-   Материалы и данные делимитации, демаркации и проверки прохождения государственной границы РФ и материалы и данные об установлении и изменении границ субъектов РФ и границ муниципальных образований\n\n-   Справочные и другие материалы.\n\nВ состав ЕЭКО входят следующие слои:\n\n-   рельеф местности с точностью, соответствующей масштабу мельче 1:50 000,\n\n-   гидрография и гидротехнические сооружения,\n\n-   растительный покров и грунты (древесная, кустарниковая, травянистая растительность, пашни, болота, прочие земли, пески, каменистые россыпи, нарушенные земли и тому подобное),\n\n-   дорожная сеть и дорожные сооружения,\n\n-   населенные пункты,\n\n-   промышленные, сельскохозяйственные и социально-культурные объекты, в том числе жилые объекты,\n\n-   государственная граница Российской Федерации,\n\n-   границы между субъектами Российской Федерации,\n\n-   наименования географических объектов,\n\n-   иная информация, не содержащая сведений, составляющих государственную тайну, и являющихся систематизированной совокупностью пространственных данных о территории Российской Федерации.\n\nСсылка на сервис: <https://portal.fppd.cgkipd.ru/main>\n\nИнструкция и справка: <https://portal.fppd.cgkipd.ru/glavnaia>\n\n```{=html}\n<iframe width=\"800\" height=\"400\" src=\"https://www.youtube.com/embed/lbYmAOhnJWw?si=IUFcV58ILlJqCr-q\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n```\n\n# Архивные карты городов\n\nНекоторые архивные карты городов в растровом формате можно найти на сайте [https://retromap.ru/select](https://retromap.ru/select)\n\nАрхивные карты (примерно до середины двадцатого века) можно попробовать найти на сайте [https://geoportal.rgo.ru/collections](https://geoportal.rgo.ru/collections)\n\nНаиболее любознательные могут попробовать поискать архивные карты в [фонде картографических изданий РНБ](https://nlr.ru/nlr_visit/RA1918/fond-kartograficheskih-izdaniy) или в каталоге [Национальной электронной библиотеки](https://rusneb.ru/).\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":true,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"number-sections":true,"shift-heading-level-by":1,"output-file":"Data-sources.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.5.57","editor":"visual","theme":"cosmo","number-depth":4,"anchor-sections":true,"title":"Открытые источники данных"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}