---
title: "Источники данных о характеристиках застройки"
format: html
---

# ГИС ЖКХ

## Скачивание данных

*ГИС ЖКХ - государственная информационная система жилищно-коммунального хозяйства*, созданная Минстроем и Минцифры РФ и содержащая в себе данные об объектах жилого фонда.

Официальный сайт: <https://portal.dom.gosuslugi.ru/>

Реестр объектов жилого фонда, содержащий информацию об объектах государственного учёта жилищного фонда, включая их технические характеристики и состояние: <https://dom.gosuslugi.ru/#!/houses>

Блок поиска содержит следующие вкладки[^1]:

[^1]: Поиск объектов жилищного фонда - <https://cdn.dom.gosuslugi.ru/webhelp/source/public_part/housing_search.html>

-   Поиск дома по адресу;

-   Поиск дома по управляющей организации;

-   Поиск дома по ОМС.

Кроме поиска отжельных домов в реестре доступна возможность формирования выгрузки сведений из реестра объектов жилищного фонда в виде архива с файлами выгрузки в формате CSV в разрезе субъектов РФ.

Для скачивания архива нажмите на кнопку **Скачать**, расположенную над блоком поиска[^2].

[^2]: Скачивание архива с файлами выгрузки - <https://cdn.dom.gosuslugi.ru/webhelp/source/public_part/download_archive.html>

![](images/och111_1.png){fig-align="center"}

::: callout-warning
Скачиваемый архив размером порядка 3,7 Гигабайт, так что необходимо будет немного подождать полной загрузки.
:::

После скачивания и распаковки архива вы увидите набор файлов в формате *.csv* с данными по отдельным регионам.

![](images/Снимок%20экрана%202025-03-02%20в%2012.47.50.png){fig-align="center"}

## Геокодирование

Полученные из ГИС ЖКХ данные не имеют явной географической привязки, а только адрес, поэтому для работы с ними, как с пространственными объектами требуют геокодирования.

> **Геокодирование** - процесс получения географических координат объектов на основе их адресов.

![Источник: https://mappa-logistics.ru/tpost/bmgh0h3z81-sravnenie-geokoderov-kakoi-luchshe-vibra](images/photo.png){fig-align="center"}

### Подготовка адреса к геокодированию

Однако перед геокодированием следует открыть данные и немного их подготовить.

Но для геокодирования необходимо обработать строку с адресом таким образом, чтобы в ней содержалось только название улицы и номер дома, а также выделим название города в отдельную колонку.

Для этого воспользуемся скриптом:

``` python
def add_sub_address_column(file_path):
    new_file = f"{file_path.split('.')[0]}_sub_address.{file_path.split('.')[1]}"
    with open(new_file, "w") as file_write:
        with open(file_path, "rt") as file_read:
            file_write.write(f"Город|Адрес|{file_read.readline().replace(',', '')[1:]}".replace('|', ','))
            for line in file_read:
                address = line.strip().split("|")[0]
                city = address.split(",")
                if len(city) == 4:
                    city = city[1].strip()
                else:
                    city = city[-3].strip()
                try:
                    city = city.split(".")[1].strip()
                except IndexError:
                    continue
                sub_address = [str_.strip() for str_ in address.split(",")[-2:]]
                sub_address_str = " ".join(sub_address)
                line = ",".join(line.split("|")[1:])
                full_line = ",".join([city, sub_address_str, f"{line}"])
                file_write.write(full_line)


add_sub_address_column(file_path="путь к вашему файлу")
```

Запустить готовый код можно напрямую из консоли python в QGIS: *Модули* $\longrightarrow$ *Консоль python.*

Консоль будет открыта в нижней части вашего окна QGIS. Для добавления вашего скрипта вы можете нажать на кнопку ![](images/Снимок%20экрана%202025-03-02%20в%2015.38.49.png){width="22" height="21"}.

После этого в правой части консоли появится небольшое окно для введения скрипта, в которое вы можете вставить нужный код.

![](images/Снимок%20экрана%202025-03-02%20в%2015.36.16.png){fig-align="center"}

Запуск кода осуществляется по кнопке *Выполнить сценарий* над вашим скриптом.

::: callout-warning
Не забудьте вставить в последней строке путь к тому файлу, который хотите обработать!
:::

По результатам обработки в вашей папке с исходным файлом появится новый с названием *"Сведения по ОЖФ Адыгея Респ на 23-02-2025_sub_address.csv"*.

### Геокодирование с использованием модуля MMQGIS

Существует большое количество сервисов геокодирования как с платным доступом, так и бесплатным. В нашем примере мы воспользуемся модулем MMQGIS[^3] и бесплатным сервисом геокодирования Nominatim[^4].

[^3]: Сайт модуля и подробное описание его функций <https://michaelminn.com/linux/mmqgis/>

[^4]: Ознакомиться с работой сервиса и почитать про него подробнее можно на сайте <https://nominatim.openstreetmap.org/ui/search.html>

Для работы с модулем прежде всего необходимо его установить. Установка может быть осуществлена из репозитория напрямую в программе: *Модули* $\longrightarrow$ *Управление модулями.*

![](images/Снимок%20экрана%202025-03-02%20в%2015.50.18.png){fig-align="center"}

После установки модуль появится в вашей строке меню.

Для геокодирования откроем модуль.

![](images/Снимок%20экрана%202025-03-02%20в%2015.51.29.png){fig-align="center"}

В открывшемся окне необходимо указать путь к файлу для геокодирования, колонки, в которых хранятся адрес и название города, а также путь к файлам для сохранения результатов.

::: callout-tip
В нашем случае город будет использоваться для повышения точности геокодирования, так как улицы с одинаковыми названиями и номерами домов могут находиться в разных городах.
:::

![](images/Снимок%20экрана%202025-03-02%20в%2015.52.18.png){fig-align="center"}

::: callout-note
Здесь мы используем бесплатный сервис, который не требует получения ключей, для использования остальных необходимо сначала получить ключ доступа *API key*.

Подробнее про различные сервисы геокодирования и их использование можно почитать [здесь](https://habr.com/ru/articles/505500/) и [здесь](https://habr.com/ru/articles/499990/).
:::

::: callout-note
Обратите внимание, что в результате вы получите векторный файл в формате *shapefile* (*.shp*) с точками домов, координаты которых были определены при геокодировании, и текстовый файл в формате *.csv* для тех объектов, где координаты найдены не были.
:::

Полученный векторный слой будет сохранять в себе все колонки исходного файла, к которым будет присоединена колонка с координатами (*latlong*).

::: callout-important
Результатом геокодирования всегда будет точечный слой, поэтому если вам нужны полигоны домов, то их необходимо получить из другого источника (например, скачать из OSM) и присоединить к ним атрибуты с использованием инструмента *Объединить по расположению*.
:::

::: callout-warning
Не забывайте, что shapefile - это коварный формат и вам нужен не только файл с расширением *.shp*, но и все другие с таким же именем, но другими расширениями.
:::

# Использование готового набора данных

## Карта возраста домов (How old is this house)

Другим вариантом загрузки возрастов зданий для различных городов является использование готового обработанного набора данных проекта картографического издательства "Кон-Тики".

В этом проекте собраны из различных источников сведения о возрасте домов для 80 наиболее крупных городов России по состоянию на 2022 год.

Данные можно посмотреть на [карте](https://kontikimaps.ru/hoith?p=cities250?p=cities250) и скачать по [ссылке](https://kontikimaps.ru/how-old/cities250/datasets?p=cities250).

Использованные в проекте источники данных показаны в таблице[^5].

[^5]: Источник: <https://github.com/kachkaev/tooling-for-how-old-is-this-house>

🔢 финальные характеристики здания (цифра означает приоритет)\
⏳ временно используемые вспомогательные данные\
🗑 данные игнорируются из-за редкости или низкого качества

📍 точка (point)\
🟥 контур (polygon / multipolygon)\

|   | адрес | архитектор | геометрия | год | название | стиль | фото | этажность |
|----|----|----|----|----|----|----|----|----|
| [**«МинЖКХ»**](https://mingkh.ru/) | 3️⃣ |  | ⏳ 📍 | 4️⃣ |  |  |  | 2️⃣ |
| [**Минкультуры**](https://opendata.mkrf.ru/) | 2️⃣ |  | ⏳ 📍 | 1️⃣ | 3️⃣ |  | 4️⃣ |  |
| [**ОСМ**](https://www.openstreetmap.org/) | 1️⃣ | 1️⃣ | 1️⃣ 🟥 | 3️⃣ | 2️⃣ | 1️⃣ | 3️⃣ | 1️⃣ |
| [**Росреестр**](https://rosreestr.gov.ru/) | 4️⃣ |  | ⏳ 📍 | 5️⃣ | 🗑 |  |  | 3️⃣ |
| [**Викиданные**](https://www.wikidata.org/) | 🗑 | 2️⃣ | ⏳ 📍 | 🗑 | 1️⃣ | 2️⃣ | 1️⃣ |  |
| [**Викимапия**](https://wikimapia.org/) | 🗑 |  | ⏳ 🟥 | 6️⃣ | 5️⃣ |  | 5️⃣ |  |
| [**Викигид**](https://ru.wikivoyage.org/) | 5️⃣ | 3️⃣ | ⏳ 📍 | 2️⃣ | 4️⃣ | 3️⃣ | 2️⃣ |  |

Подробнее описание процесса сбора данных описано в [статье о проекте](https://kontikimaps.ru/how-old/cities250/process).

::: callout-note
Если вы достаточно любопытны и не боитесь работать с кодом и командной строкой, то можете попробовать создать аналогичный набор данных для любого города, воспользовавшись [инструментом, созданным для проекта](https://github.com/kachkaev/tooling-for-how-old-is-this-house).
:::

## Данные об объектах культурного наследния Wikivoyage

**Wikivoyage (Викигид** <http://wikivoyage.org/>) **-** проект по созданию открытого всемирного путеводителя.

Для загрузки данных можно воспользоваться парсером данных, код которого доступен по [ссылке](https://github.com/trolleway/wikivoyage2geodata?tab=readme-ov-file).

Либо можно скачать готовую выгрузку по результатам работы парсера по [ссылке](https://trolleway.nextgis.com/resource/2478/display?angle=0&zoom=10&styles=5214&base=osm-mapnik&lon=37.8454&lat=55.7225).

```{=html}
<iframe src="https://trolleway.nextgis.com/resource/2478/display/tiny?angle=0&zoom=10&styles=5214&linkMainMap=true&events=false&panel=none&controls=&panels=&base=osm-mapnik&lon=37.8454&lat=55.7225" style="overflow:hidden;height:600px;width:800px" height="600" width="800"></iframe>
```

# Данные ЕГРН

## Получение данных Национальной структуры пространственных данных

::: callout-caution
Показанный ниже метод опирается на не задокументированный доступ через инструменты разработки в браузере.
:::

```{=html}
<iframe src="https://rutube.ru/play/embed/4a14444a2b99278f2b348ec1668d75a2/" width="720" height="405" frameBorder="0" allow="clipboard-write" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
```

```{=html}
<iframe width="720" height="405" src="https://rutube.ru/play/embed/c5e7367799c24329c03edf90dfceab87/" frameBorder="0" allow="clipboard-write" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>
```

## Получение данных из выписок ЕГРН и КПТ

Если у вас есть выписка из ЕГРН на объект недвижимости или кадастровый план территории на кадастровый квартал в формате *.xml*, то вы можете попробовать загрузить данные из них в QGIS.

Но их загрузка требует извлечения пространственной составляющей (координат характерных точек объектов недвижимости). Самый простой способ конвертации - онлайн-сервис от компании ПолигонПРО:

-   **Конвертер XML-файлов в формат Shapefile** <https://polygon.top/ws/shp/>

-   **Конвертер XML-файлов в формат MIF/MID** <https://polygon.top/ws/mif/>

![](images/Снимок%20экрана%202025-03-02%20в%2019.30.14.png){fig-align="center"}

Полученные в результате конвертации файлы после разархивирования могут быть открыты как обычные векторные файлы.

::: callout-important
Полученные координаты будут представлены в местной системе координат для конкретного кадастрового округа, так как используются именно внесенные в ЕГРН данные.

Поэтому дополнительно нужно задать параметры местной системы координат в QGIS.

В каталоге систем координат QGIS содержится порядка 5000 тысяч описаний систем координат, однако иногда их использования недостаточно, тогда вы можете добавить в каталог свою пользовательскую систему координат. Это можно сделать через строку меню **Настройки --- Пользовательские проекции**.

![](images/76.png)

После этого вам откроется окно, в котором можно задать параметры нужной вам системы координат в формате WKT или proj.

![](images/77.png)

> Описание параметров различных систем координат можно найти, например, [здесь](https://terraingis.ru/category/dannye-dlya-gis/msk).

![](images/78.png)

После добавления ваша система координат станет доступна в каталоге как для перепроецирования на лету, так и для перепроецирования слоев в разделе Пользовательские системы координат.

![](images/79.png)
:::

Скорее всего открытый векторный файл будет отображаться в вашем проекте как файл без проекции или с ошибочной системой координат (справа от имени файла будет иконка с вопросительным знаком ![](images/Снимок%20экрана%202025-03-02%20в%2020.37.38.png){width="31"}).

Для присвоения ему нужной системы координат следует просто кликнуть по названию файла правой кнопкой и выбрать пункт *Система координат слоя* $\longrightarrow$ *Изменить систему координат слоя* (или же выбрать из предлагаемого списка недавно использованных систем координат нужную).

![](images/Снимок%20экрана%202025-03-02%20в%2020.38.14.png){fig-align="center"}

После этого слой будет отображаться на вашей карте должным образом.

Если у вас нет выписки из ЕГРН или кадастрового плана территории, то вы можете скачать их для нужной территории/объектов из [Архива КПТ](https://polygon.top/ws/fir/).

::: callout-caution
Сервис является платным.

Также следует помнить, что данные загружаются пользователями сервиса и могут быть уже неактуальными.
:::
